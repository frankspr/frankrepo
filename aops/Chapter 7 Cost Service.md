# 第七章 运维成本服务
### 本章起草人：梁定安（腾讯SNG运维负责人）

## 1. 整体框架

### 1.1 概述

运维团队的核心职责：质量、效率、成本，成本管理是应用运维团队很重要的能力之一，本规范将介绍成本管理的三大能力模型的不同成熟度模型，引用行业最佳实践，为读者提供更通俗易懂的参考。

![](http://7xl5e0.com1.z0.glb.clouddn.com/C7001.jpg)

图片地址：http://7xl5e0.com1.z0.glb.clouddn.com/C7001.jpg

### 1.2 框架图

![](http://7xl5e0.com1.z0.glb.clouddn.com/C7002.jpg)

图片地址：http://7xl5e0.com1.z0.glb.clouddn.com/C7002.jpg

## 2. 最佳实践
### 2.1 设备成本管理能力

在应用运维的成本管理能力模型中，设备与带宽的管控能力是最能体现运维对运营成本的管控水平的两项，本章节通过应用运维对设备成本管理的案例，阐述设备管理能力在不同能力模型分级的实践经验。

#### 2.1.1 可管理级最佳实践
##### 2.1.1.1 概述
设备成本的可管理级，主要是设备规模不大、设备运营成本未成为运营成本主要矛盾的阶段下，应用运维团队被动对设备成本的管控状况。

##### 2.1.1.2 最佳实践
- 被动响应需求式的支持设备成本管理任务。
- 使用离线工具来完成设备成本的统计、核算、分类等工作，如excel等表格类软件。
- 设备管理线下流程化，如“统一硬件机型管理标准”，“制定设备采购、使用、退役管理流程”，“设备预算核算管理办法”，以保证设备的流转有据可依。

	设备成本可管理级，对精细化管理的要求不高，能实现对硬件成本的核算和利用率提高即可达到此成熟度模型的要求。

#### 2.1.2 已定义级最佳实践
##### 2.1.2.1 概述
设备成本管理在第三级已定义级的阶段，应用运维团队重点是通过建设管理系统来强化设备成本的线上管理能力，逐渐从离线工具管理升级为设备系统管理，此系统可与CMDB配置管理数据库关联设备资产信息，为设备成本管理效率提升埋下坚实的基础。

##### 2.1.2.2 最佳实践
设备成本管理系统通常应具备：预核算管理、业务归属管理、设备分布管理、趋势分析管理、容量度量等功能。

![](http://7xl5e0.com1.z0.glb.clouddn.com/C7003.jpg)

图片地址：http://7xl5e0.com1.z0.glb.clouddn.com/C7003.jpg

- 预核算管理，主要是对业务使用的设备总成本进行管理，在设备成本合理使用的前提下，充足的设备预算能够支撑业务的快速发展。
- 业务归属管理，用于记录与区分不同业务线使用的设备管理能力，便于设备成本核算时，能够快速且准确将总的设备运营成本拆分到具体不同的业务线。
- 设备分布管理功能，主要在宏观层面对整体设备分布进行统筹管控，便于因地制宜的做好设备预算规划，让业务发展与设备使用的诉求密切关联，并且更好的指导运营规划团队的IDC规划。
- 趋势管理功能，以图表的形式体现业务在不同时间点的设备成本走势，便于运维更好管控设备的库存量和采购量。
- 容量度量功能，根据硬件设备的主要性能特征，对设备使用的合理性进行度量，以保证设备成本的真实使用情况都被运维掌控。

通过设备管理系统的建设，应用运维可以很便捷实现设备成本的管控，并可制定成本定期review方案，让设备运营成本管理更加清晰透明。

#### 2.1.3 量化管理级最佳实践
##### 2.1.3.1 概述
设备成本量化管理级，是根据公司和业务的成本管理要求，在已定义级的管理系统基础上，制定恰当的指标并度量各个业务线设备成本的使用情况，让业务运维和开发能够基于此目标开展相应的技术优化工作，使企业设备成本

##### 2.1.3.2 最佳实践
度量与考核设备成本的合理性，推进优化技术使企业设备使用结构最优化，可以有几个办法：

- 容量指标管理，利用容量度量功能，制定符合企业成本管理要求的管理方案，在兼顾运维质量与效率的前提下，优化设备成本。如多核CPU负载不均，通过设置CPU绑定或亲和性优化。
- 灵活的资源管理，根据业务特性灵活组合或分配设备硬件资源，已达到设备使用结构最合理化。如CPU计算型服务与存储型服务混合部署，使用虚拟化技术将硬件资源碎片化利用等。
- 技术架构革新，如同步调用优化为异步调用，利用分布式架构优化性能瓶颈等。
- 产品策略与技术优化并重，在特定的场景下产品策略的调整比技术优化效果更显著。如离线计算比实时计算更容易节省设备资源。

![](http://7xl5e0.com1.z0.glb.clouddn.com/C7004.jpg)

图片地址：http://7xl5e0.com1.z0.glb.clouddn.com/C7004.jpg

#### 2.1.4 优化管理级最佳实践	
##### 2.1.4.1 概要
通过数据分析，精确预测与业务发展相符的设备成本，引入新技术、自动化等能力，使设备成本管理步入智能化阶段。

##### 2.1.4.2 最佳实践
（暂无）

===

### 2.2 带宽成本管理能力
带宽成本在公司IT成本管理中与设备成本的重要性一致，对于互联网公司而言，带宽成本如控制不当会造成巨大的浪费，本节重点从技术手段和产品策略两个角度阐述带宽优化的实践理论。

#### 2.2.1 可管理级最佳实践
##### 2.2.1.1 概要
带宽成本可管理级，应用运维团队应该熟知运营商对带宽的计费规则，包含CDN和IDC分别使用带宽成本结构，根据公司各个业务使用带宽的情况，能按要求计算出带宽成本数据。（备注：CDN带宽比IDC带宽价格更低，在带宽使用整体数量不变的前提下，CDN带宽占比重越大，企业带宽成本越低。“CDN带宽消耗”下文简称OC带宽，“IDC带宽消耗”下文简称DC带宽）。

##### 2.2.1.2 最佳实践
- 响应需求式的支持设备成本管理任务，需明确带宽月度计费规则。如OC与DC的选型，OC或DC带宽成本计费方案的不同。
- 使用离线工具来完成带宽成本的统计、核算、分类等工作，如excel等表格类或画图类软件。
- 带宽管理流程化。如制定“带宽预核算管理办法”等规则，以保证带宽成本可控。

#### 2.2.2 已定义级最佳实践
##### 2.2.2.1 概要
带宽成本已定义级，运维团队根据带宽管理需要，建设带宽成本管理系统，提升对带宽管控能力。

##### 2.2.2.2 最佳实践
带宽成本管理系统通常需要包含如下几大功能：预核算管理、业务归属管理、趋势管理等功能。

- 预核算管理，主要是对业务使用的OC和DC带宽进行月度/年度的预测与核算，让业务使用带宽有计划与可控。如年度带宽预算管理与月度带宽核算管理。
- 业务归属管理功能，基于CMDB系统，对带宽计算相关的外网IP地址或域名等配置项与业务关联起来，为带宽成本预核算提出数据支持；
- OC与DC管理功能，带宽成本有OC与DC两种，针对不同的使用场景，管理系统应有能力区分统计。
- 趋势管理功能，记录在不同时间点带宽的走势，便于运维核对带宽的实际使用与业务指标的发展管理。

通过带宽管理系统的建设，应用运维可以很便捷的实现带宽成本的管控，并可制定成本定期回顾方案，让带宽运营成本管理更加清晰透明。

#### 2.2.3 量化管理级最佳实践
##### 2.2.3.1 概述
带宽使用可度量，带宽成本的合理性将成为成本考核的要求。推进技术优化，促使带宽使用最优化，是量化管理级成熟度模型的重点。

##### 2.2.3.2 最佳实践
- OC与DC带宽结构合理配比，提升OC命中率，降低DC带宽占比，有利于带宽总成本下降。如扩容OC缓存的能力，用更廉价的OC换DC的带宽消耗。
- 技术架构革新，如协议级优化，图片webP压缩，视频码率降低等。
- 产品策略配合技术优化，如业务下载限速，分片下载等策略。
- 安全策略，如限制外链，扫黄打非。
	
提前预防在带宽成本的管控中尤为重要，因为带宽成本与设备成本管理不同，带宽是事后计费的，往往我们发现考核不符合预期时，已经产生了较预算更高的费用。因此，对带宽成本的管控应技术先行，保证更精细化与最优化。

#### 2.2.4 优化管理级最佳实践
##### 2.2.4.1 概述
带宽成本优化管理级，要求应用运维团队根据业务特性不同，通过数据分析，精确预测与业务发展相符的带宽成本，应用运维团队要多与产品、开发沟通，寻找用户体验和带宽成本消耗的最优性价比方案，并持续革新运维能力，使带宽成本管理迈入智能化阶段。

##### 2.2.4.2 最佳实践
(暂无)

===

### 2.3 运维服务交付成本管理能力
运维团队的核心职责是为业务交付“质量、效率、成本”的优质服务，运维服务交付成本最优化是运维自身的能力建设成果的体现，交付能力包括：服务化能力、架构能力、监控能力、自动化能力等纬度，本节将展开阐述交付成本管理能力的细节。

#### 2.3.1 可管理级最佳实践
##### 2.3.1.1 概述
运维服务交付管理在可管理级阶段，业务规模与设备规模相对不大，业务对运维的能力要求相对不高，运维被动响应发布变更、监控、故障处理等需求，围绕着有限的服务目录，交付运维能力服务。

##### 2.3.1.2 最佳实践
- 交付基础运维能力，为业务提供系统运维服务。如系统重装、进程管控、软件安装等。
- 交付基础监控能力，如基础硬件性能监控、进程端口监控等。
- 交付硬件设施管理能力，如设备选型与交付管理、宕机维护、备件替换等。
- 交付排障能力，如容量恢复、硬盘空间清理等能力。

#### 2.3.2 已定义级最佳实践
##### 2.3.2.1 概述
应用运维团队在已定义级阶段，将明确对业务交付的标准化服务目录，服务范围较可管理级有扩大，围绕着服务目录中的交付能力进行系统化或工具化的支持，降低运维能力的交付成本。非运维服务目录包含的工作也会逐渐被纳入标准化运维规范中，朝更低交付成本的运维系统中转移。

##### 2.3.2.2 最佳实践

![](http://7xl5e0.com1.z0.glb.clouddn.com/C7005.jpg)

图片地址：http://7xl5e0.com1.z0.glb.clouddn.com/C7005.jpg

- 运维效率系统，这是通用的运维能力，运维提供系统化的能力支持，高效高质量的实现业务变更需求。如持续部署系统等。
- 运维监控系统，业务质量的监控、告警、度量能力，通过运维监控系统的建设，将以服务化的形式交付给业务团队使用。如系统级监控、应用级监控。
- 事件管理系统，定义生产环境的突发事件，并且制定适宜的流程管理办法与责任人制，让每个会影响业务质量或运维质量的问题都能得到根治。
- 需求流程系统，对于未能实现系统化交付的运维能力，通过制定需求流程规则，承诺交付完成时间（SLA）和完成质量，以达到业务方需求被有序并高效的响应和处理。

#### 2.3.3 量化管理级最佳实践
##### 2.3.3.1 概述
运维提出标准化组件管理规范，围绕标准化建立运维平台，运维能力以产品化或服务化的模式提供，业务遵守运维规范要求，便能享受高效的运维服务。此成熟度模型下，对业务提出高标准化的管理要求，逐渐将运维对象收拢并统一管理。

##### 2.3.3.2 最佳实践

![](http://7xl5e0.com1.z0.glb.clouddn.com/C7006.jpg)

图片地址：http://7xl5e0.com1.z0.glb.clouddn.com/C7006.jpg

- 运维效率系统，常用操作从自动化服务逐渐升级为智能化服务，运维效率系统联动监控系统智能决策自动化事件的触发，并以质量系统的结果度量智能决策的效果。
- 运维质量系统，根据经验模型对异常事件进行自动化修复，业务质量具备自愈能力，未知的异常事件将被快速识别并告警，质量度量由监控异常迈入监控未知问题阶段。如运维聚焦未知问题，已经故障都将由经验模型自动化修复，无需人为介入。
- 需求流程系统，运维非自动化的能力服务化，以接口调用的形式串联需求涉及的每个环节，降低人工操作的成本。
- 事件管理系统，突发事件将智能关联所有与之相关的监控异常信息，数据来源于运维效率系统和运维质量系统，使突发事件在产生的同时结论也将被负责人一并获知。

运维交付能力在量化管理级阶段，主要强调不同运维能力系统间的相互对接与合作，基于更强大更多维度的数据整合，运维服务能力进入智能化时代。

#### 2.3.4 优化管理级最佳实践
##### 2.3.4.1 概述
通过架构能力和运维平台能力的不断优化提升，运维交付能力步入智能决策和全自动化时代，运维服务交付成本最低。

##### 2.3.4.2 最佳实践
（暂无）





